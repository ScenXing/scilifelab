<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>BCBB pipeline</title>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/brainstorm.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
    setupPreso(false, './');
  });
  </script>
</head>

<body>


<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">&larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">z</td><td>toggle help (this)</td></tr>
  </table>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content" ref="intro/01_phylosophy/1">
<h1>Blue Collar Bioinformatics NGS pipeline</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental center" ref="intro/01_phylosophy/2">
<h1>Original Idea</h1>

<p><img src="./file/intro/chapman.jpg" width="104" height="136" alt="chapman"/></p>

<h3>Brad Chapman</h3>

<h4>Massachussets General Hospital</h4>

<h4><strong>Very</strong> active bioinformatics developer</h4>

<h4>twitter:@chapmanb github:chapmanb</h4></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental center" ref="intro/01_phylosophy/3">
<h1>Contributors</h1>

<h3>Roman Valls Guimera</h3>

<h4>Science for Life Laboratory Stockholm</h4>

<h4>Not to confuse with Sci-Fi</h4>

<h4>http://scilifelab.se</h4>

<h4>twitter:@braincode github:brainstorm</h4></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="intro/01_phylosophy/4">
<p><img src="./file/intro/github.png" width="1144" height="892" alt="github.png"/></p></div>
</div><div class="slide" data-transition="none"><div class="content center bullets incremental" ref="intro/01_phylosophy/5">
<h1>Vision</h1>

<ul>
<li>Illumina sequencer ends run</li>
<li>Convert to standard FastQ format</li>
<li>Align against reference genome</li>
<li>SNP calling, variant eval &amp; effect</li>
<li>Summary PDF report</li>
</ul>


<h2>"Automate, fix, improve, automate"</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental transition-fade" ref="intro/01_phylosophy/6">
<h1>Objectives</h1>

<ul>
<li>Provide an automatic <strong>preliminar</strong> analysis</li>
<li>Transform data, ready to use on UPPMAX: SAM, BAM, BAM-sorted, bigwig...</li>
<li>Perform adhoc analysis with Galaxy</li>
<li>Perform further adhoc analysis outside Galaxy</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content small center" ref="intro/01_phylosophy/7">
<h1>Automation</h1>

<pre><code>"(...) It [processing] does take a bit, but that's why it's
nice to have it automated, it'll all go
off in the middle of night
without having to think about it."

                        -- Brad Chapman
</code></pre></div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_phylosophy/8">
<h2>Good coders code, great <strong>reuse</strong></h2>

<h3>NGS analysis</h3>

<ul>
<li>Picard</li>
<li>GATK</li>
<li>bowtie</li>
<li>bwa</li>
<li>tophat</li>
<li>samtools</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_phylosophy/9">
<h2>NGS analysis (cont)</h2>

<ul>
<li>snpEff</li>
<li>fastx toolkit</li>
<li>FastQC</li>
<li>matrix2png</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_phylosophy/10">
<h2>Python modules</h2>

<ul>
<li>Biopython</li>
<li>pysam</li>
<li>mako</li>
<li>PyYAML</li>
<li>amqplib</li>
<li>logbook</li>
<li>nosetests</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_phylosophy/11">
<h2>Processing infrastructure</h2>

<ul>
<li>RabbitMQ</li>
<li>LaTeX</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollUp"><div class="content bullets incremental" ref="intro/01_phylosophy/12">
<h2>Optional software for generating report graphs</h2>

<ul>
<li>R with ggplot2, plyr, sqldf libraries.</li>
<li>rpy2</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center small" ref="intro/01_phylosophy/13">
<h1>Collaborative software development</h1>

<p><img src="./file/intro/softdevel.png" width="611" height="815" alt="softdevel.png"/></p></div>
</div><div class="slide" data-transition="none"><div class="content center small" ref="intro/01_phylosophy/14">
<h1>Flexibility vs Complexity</h1>

<p><img src="./file/intro/groucho.jpg" width="432" height="473" alt="groucho.jpg"/></p>

<h2>"Those are my principles, if you don't like them, I've others"</h2>

<h4>-- Groucho Marx</h4></div>
</div><div class="slide" data-transition="none"><div class="content center small" ref="intro/01_phylosophy/15">
<h1>"Talk is cheap, show me the code"</h1>

<h4>-- Linus Torvalds (Linux Kernel hacker)</h4></div>
</div><div class="slide" data-transition="none"><div class="content center small commandline incremental" ref="intro/01_phylosophy/16">
<pre><code><code class="command">$ cd bcbb/nextgen/scripts &amp;&amp; find</code><code class="result">
./picard_gatk_recalibrate.py
./picard_maq_recalibrate.py
./analyze_quality_recal.py
./automated_initial_analysis.py
./bam_to_wiggle.py
./analyze_finished_sqn.py
./utils/resort_bam_karyotype.py
./utils/broad_redo_analysis.py
./utils/convert_samplesheet_config.py
./utils/sort_gatk_intervals.py
./solexa_qseq_to_fastq.py
./upload_to_galaxy.py
./store_finished_sqn.py
./picard_sam_to_bam.py
./variant_effects.py
./align_summary_report.py
./gatk_variant_eval.py
./monthly_billing_report.py
./barcode_sort_trim.py
./illumina_finished_msg.py
./gatk_genotyper.py

</code><code class="command">$ find . -iname "*.py" | xargs wc -l </code><code class="result">
(...)
4264 totalt
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content blindX" ref="intro/03_numbers/1">
<h1>Initial quantitative analysis on requirements</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/03_numbers/2">
<h1>Metrics</h1>

<ul>
<li>CPU Time: Bcl2Qseq: 5h Qseq2Fastq: ~2h</li>
<li>Space: ~600GB raw data, ~1.5TB after pre-processing</li>
<li>Bandwidth: 25 MBytes/s (!!!)</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center" ref="arch/01_backend/1">
<h1>Overall architecture</h1>

<p><img src="./file/arch/backend.png" width="514" height="497" alt="backend diagram"/></p></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="arch/01_backend/2">
<h1>Who is who ?</h1>

<h2>Sequencing machines: Scilifelab</h2>

<h3>Sequencers "sink" + preprocessing (FastQ)</h3>

<h2>Galaxy and analysis machine: Uppsala univ. (UPPMAX) cluster</h2>

<h3>Demultiplexing, initial analysis (PDF) and beyond (Galaxy)</h3>

<h2>Storage machine: UPPMAX too</h2>

<h3>Saving datasets for long term archival: SWESTORE</h3>

<h3>Future: Initial steps on iRODs system</h3></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="inner_workings/01_files_generated">
<p><img src="./file/inner_workings/./files_generated_far.png" width="1901" height="1116" alt="moo"/></p></div>
</div><div class="slide" data-transition="none"><div class="content" ref="inner_workings/03_barcoding/1">
<h1>How do we barcode ?</h1></div>
</div><div class="slide" data-transition="none"><div class="content commandline incremental small" ref="inner_workings/03_barcoding/2">
<pre><code><code class="command">$ ls 110217_SN167_0251_A8158LABXX/1_110217_A8158LABXX_barcode</code><code class="result">

1_110217_A8158LABXX_5_1_fastq.txt
1_110217_A8158LABXX_5_2_fastq.txt
1_110217_A8158LABXX_6_1_fastq.txt
1_110217_A8158LABXX_6_2_fastq.txt
1_110217_A8158LABXX_unmatched_1_fastq.txt
1_110217_A8158LABXX_unmatched_2_fastq.txt
1_110217_A8158LABXX_bc.metrics
SampleSheet-barcodes.cfg

</code><code class="command">$ cat 1_110217_A8158LABXX_barcode/SampleSheet-barcodes.cfg </code><code class="result">
6 TGACCAA
5 GCCAATA

</code><code class="command">$ cat 1_110217_A8158LABXX_barcode/1_110217_A8158LABXX_bc.metrics</code><code class="result">
5   25873823
6   29331527
unmatched   3051668
</code></code></pre></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="results/01_reports/1">
<h1>Tile quality metrics</h1>

<p><img src="./file/results/good_flowcell.png" width="1148" height="819" alt="good_flowcell.png"/></p></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="results/01_reports/2">
<h1>Tile quality metrics</h1>

<p><img src="./file/results/bad_flowcell.png" width="1148" height="808" alt="bad_flowcell.png"/></p></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="results/02_showtime">
<h1>Show PDF examples !</h1>

<p>Mental note: results folder !</p></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="help/01_contributors/1">
<h1>How can you help ?</h1>

<ul>
<li>Reporting bugs</li>
<li>Giving feedback</li>
<li>http://github.com/scilifelab</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content center" ref="help/01_contributors/2">
<p><img src="./file/help/issues.png" width="1166" height="630" alt="issues.png"/></p></div>
</div><div class="slide" data-transition="none"><div class="content code small smaller center" ref="ending/01_ack">
<h1>Got ack'd on upcoming paper !</h1>

<pre><code>\section*{Acknowledgements}
Tammy Gillis, Shangtao Liu and Kaleena Shirley provided
valuable insight on the web interface and laboratory management
functionality. Roman Valls Guimera and Konrad Paszkiewicz eased
installation and configuration by patiently providing feedback
as early adopters of the software.
</code></pre>

<h3>https://github.com/chapmanb/mgh_projects/blob/master/nglims_paper/nglims_galaxy.tex</h3></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="ending/02_future">
<h1>Future</h1>

<ul>
<li>Add support for other platforms, generalize</li>
<li>Parallellizing strategy on cluster</li>
<li>Bring Galaxy up with the generated datasets</li>
<li>Test, fix, improve, automate</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="ending/02_thanks">
<h1>Tack s&#xE5; mycket</h1>

<h3>Per Kraulis</h3>

<h3>Ellen Sherwood</h3>

<h3>Thomas Svensson</h3>

<h3>Fredrik Lennmark</h3>

<h3>Eric Bj&#xF6;rkvall</h3>

<h3>Magnus Bjursell</h3>

<h3>JingWen Wang</h3>

<h3>Rezin Dilshad</h3>

<h3>Bioinformatics "quadrant"</h3>

<h3>Emma Sernstrad</h3>

<h3>Brad Chapman</h3></div>
</div><div class="slide" data-transition="none"><div class="content center" ref="ending/03_scilifelab_refs">
<h2>Talk is cheap, show me the refs !</h2>

<h4>Code and docs for Backend: <a href="https://github.com/brainstorm/bcbb/tree/master/nextgen" title="Backend">https://github.com/brainstorm/bcbb/tree/master/nextgen</a></h4>

<h4>Code and docs for Frontend: <a href="http://bcbio.wordpress.com/2011/01/11/next-generation-sequencing-information-management-and-analysis-system-for-galaxy/" title="Frontend">http://bcbio.wordpress.com/2011/01/11/next-generation-sequencing-information-management-and-analysis-system-for-galaxy/</a></h4></div>
</div>
</div>

</body>
</html>
